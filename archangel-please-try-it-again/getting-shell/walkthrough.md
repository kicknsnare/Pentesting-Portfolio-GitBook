# Walkthrough

```bash
#Commands
nmap -sV -sC -oN nmap/initial 10.10.104.151
nmap -p- -sV -T4 -sC -oN nmap/all_ports 10.10.104.151
gobuster dir -u http://10.10.104.151/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt | tee initialGB.log
nano /etc/hosts
#Learned:
sh -c "echo '10.10.104.15    mafialive.thm' >> /etc/hosts"
--
ffuf -u http://mafialive.thm/FUZZ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/big.txt

```

<figure><img src="https://camo.githubusercontent.com/4b842b3b0c7d6fadad90a9f855988164603dc3da141d0de07175bd39c1f010c6/68747470733a2f2f692e696d6775722e636f6d2f654c4b4c7372682e706e67" alt=""><figcaption></figcaption></figure>

&#x20;

<figure><img src="https://camo.githubusercontent.com/def71025c671cceda8b87e1916b9dafac95528de4aaa0052a21c6f7a3ca4c520/68747470733a2f2f692e696d6775722e636f6d2f545551386d7a632e706e67" alt=""><figcaption><p>I found the host from the email</p></figcaption></figure>

<figure><img src="https://camo.githubusercontent.com/82193db3de32b3e29806f298502ce62f55d17b7070c290b503badc9d5c95d60a/68747470733a2f2f692e696d6775722e636f6d2f7062737443356b2e706e67" alt=""><figcaption></figcaption></figure>

<figure><img src="https://camo.githubusercontent.com/a425749e75cfbb0e9484e4f647fed31027e87b79bb28596ff939ce52add8d9af/68747470733a2f2f692e696d6775722e636f6d2f5453344b735a492e706e67" alt=""><figcaption></figcaption></figure>

&#x20;a

Find a different hostname&#x20;

<mark style="color:green;">mafialive.thm</mark>

Find flag 1

<mark style="color:green;">thm{f0und\_th3\_r1ght\_h0st\_n4m3}</mark>

Look for a page under development\
<mark style="color:green;">test.php</mark>



<figure><img src="https://camo.githubusercontent.com/be694737a3db04d0f78a543f5bdccba2a771942fda86df7541478d5b9bfea918/68747470733a2f2f692e696d6775722e636f6d2f6b304e784b45322e706e67" alt=""><figcaption></figcaption></figure>

&#x20;

<figure><img src="https://camo.githubusercontent.com/7bee5b045d80d6bf5069e17ade1ed2fab50febbcc05bf15890020e286476be71/68747470733a2f2f692e696d6775722e636f6d2f684a75705a45302e706e67" alt=""><figcaption></figcaption></figure>

Inside robots txt I found the test.php directory



Find flag 2\
<mark style="color:green;">thm{explo1t1ng\_lf1}</mark>

First I used burp suite to play with the url and I used multiple options until I got the contents of /etc/passwd but it was no how the box was meant to be done. It wanted us to look for the filter and decode the base64 encodings

<figure><img src="https://camo.githubusercontent.com/c302c0bff1172c435fc0b712dbdc62db131ac288191810d6fe9808845d071be0/68747470733a2f2f692e696d6775722e636f6d2f4f6132785838662e706e67" alt=""><figcaption></figcaption></figure>

&#x20;

<figure><img src="https://camo.githubusercontent.com/3be355944111025b204d033a1c756ca7b02e3d6bbc2aeb512019529889e37792/68747470733a2f2f692e696d6775722e636f6d2f5933624a3768322e706e67" alt=""><figcaption></figcaption></figure>

&#x20;

<figure><img src="https://camo.githubusercontent.com/63688f8ec536559a67ce2700abfdd6152554fea3b2198e58f841a69a795e0c07/68747470733a2f2f692e696d6775722e636f6d2f3469745a4269502e706e67" alt=""><figcaption></figcaption></figure>

&#x20;

Get a shell and find the user flag\
<mark style="color:green;">thm{lf1\_t0\_rc3\_1s\_tr1cky}</mark>

\
